로그인 프로세스

- 클라이언트로부터 요청 (request body에 데이터가 포함되어 있음)

1. request body의 데이터가 유효한 데이터인지 확인
1-1. 만약 유효하지 않은 데이터이면 "VF" 응답 처리

1번 처리후 (userId, userPassword) 데이터를 받아옴

2. 데이터베이스의 user 테이블에서 (userId)에 해당하는 유저 레코드 조회
select * from user where userId = :userId and userPassword = :userPassword
2-1. 만약 유저 레코드가 존재하지 않으면 'SF' 응답 처리
2-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

3. 조회한 레코드의 암호화된 비밀번호와 사용자가 입력한 평문의 비밀번호가 일치하는지 비교
3-1. 만약 비밀번호가 서로 일치하지 않으면 'SF' 응답 처리

4. JWT로된 accessToken 생성
4-1. 만약 accessToken 생성 중 에러가 발생하면 'TF' 응답 처리

5. 'SU' 응답 처리 (accessToken, expires 데이터가 포함되어 있음)

---------------------------------------------------------------------------------------------------------
아이디 중복확인 프로세스

- 클라이언트로부터 요청 (request body에 데이터가 포함되어 있음)

1. request body의 데이터가 유효한 데이터인지 확인(가장 먼저 체크해야 될 것!!)
1-1. 만약 유효하지 않은 데이터이면 "VF" 응답 처리

1번 처리후 (userId) 데이터를 받아옴

- 비즈니스 로직 구현

2. 데이터베이스의 user 테이블에서 해당하는 (userId)를 가지고 있는 유저가 있는지 확인(boolean)
2-1. 만약 가지고 있는 유저가 존재하면 'DI' 응답 처리
2-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

3. 중복된 (userId)가 없다면 'SU' 응답 처리

---------------------------------------------------------------------------------------------------------
이메일 인증 프로세스

- 클라이언트로부터 요청 (request body에 데이터가 포함되어 있음)

1. request body의 데이터가 유효한 데이터인지 확인
1-1. 만약 유효하지 않은 데이터이면 "VF" 응답 처리

1번 처리후 (userEmail) 데이터를 받아옴

- 비즈니스 로직 구현

2. 데이터베이스의 user 테이블에서 해당하는 (userEmail)를 가지고 있는 유저가 있는지 확인(boolean)
2-1. 만약 가지고 있는 유저가 존재하면 'DE' 응답 처리
2-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

3. 4자리의 인증 번호를 생성

4. email_auth_number 테이블에 userEmail과 생성한 4자리의 인증 번호를 저장
4-1. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

5. userEmail에 생성한 4자리의 인증 번호를 전송
5-1. 만약 이메일 전송 중에 에러가 발생하면 email_auth_number 테이블에 저장한 데이터를 삭제
5-2. 만약 이메일 전송 중에 에러가 발생하면 'MF' 응답 처리

6. 'SU' 응답 처리

---------------------------------------------------------------------------------------------------------
이메일 인증 확인 프로세스

- 클라이언트로부터 요청 (request body에 데이터가 포함되어 있음)

1. request body의 데이터가 유효한 데이터인지 확인
1-1. 만약 유효하지 않은 데이터이면 "VF" 응답 처리

1번 처리후 (userEmail, authNumber) 데이터를 받아옴

- 비즈니스 로직 구현

2. 데이터베이스의 email_auth_number 테이블에서 해당하는 (userEmail, authNumber)를 모두 가지고 있는 데이터가 있는지 확인
2-1. 해당하는 데이터가 없다면 'AF' 응답 처리
2-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

3. 'SU' 응답 처리

---------------------------------------------------------------------------------------------------------
회원가입 프로세스

- 클라이언트로부터 요청 (request body에 데이터가 포함되어 있음)

1. request body의 데이터가 유효한 데이터인지 확인
1-1. 만약 유효하지 않은 데이터이면 "VF" 응답 처리

1번 처리후 (userId, userPassword, userEmail, authNumber) 데이터를 받아옴

- 비즈니스 로직 구현

- 데이터베이스 제약조건으로 다시 검사 (user_id ... PRIMARY KEY) / PRIMARY KEY = NOT NULL + UNIQUE
2. 데이터베이스의 user 테이블에서 해당하는 (userId)를 가지고 있는 유저가 있는지 확인
2-1. 만약 가지고 있는 유저가 존재하면 'DI' 응답 처리
2-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

- 데이터베이스 제약조건으로 다시 검사 (user_email ... UNIQUE)
3. 데이터베이스의 user 테이블에서 해당하는 (userEmail)를 가지고 있는 유저가 있는지 확인
3-1. 만약 가지고 있는 유저가 존재하면 'DE' 응답 처리
3-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

- 데이터베이스 제약조건으로 다시 검사 (CONSTRAINT user_email_fk FOREIGN KEY...)
4. 데이터베이스의 email_auth_number 테이블에서 해당하는 (userEmail, authNumber)를 모두 가지고 있는 데이터가 있는지 확인
4-1. 해당하는 데이터가 없다면 'AF' 응답 처리
4-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

5. 사용자로부터 입력받은 userPassword를 암호화

6. 사용자로부터 입력받은 userId, userEmail과 암호화한 password, 지정된 권한, 가입경로를 사용하여 데이터베이스의 user 테이블에 레코드를 삽입
6-1. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

7. 'SU' 응답 처리

-------------------------------------------------------------------------------------------------------------
관리자 권한 프로세스

client가 header에 bearer 토큰을 포함하여 요청

0. 해당 요청의 메서드와 URL을 보고 인증 인가가 필요한 요청인지 확인
0-1. 만약 인증 및 인가 작업에 실패하면 'AF' 응답 처리

1. hearer의 Authorization 필드에 값이 있는지 확인
2. 해당 요청의 인증 방식이 Bearer 인증 방식인지 확인
3. Authorization 필드에 값에서 토큰 추출
4. 토큰의 유효성 판단
5. 토큰에서 userId 추출
6. userId로 데이터베이스에서 조회
7. 조회 결과로부터 사용자의 권한을 추출
8. context에 request의 정보와 접근 주체의 정보를 추가
9. 접근 주체가 해당 요청을 사용할 권한이 있는지 확인


10. 컨트롤러의 메서드에서 인증 접근 주체의 정보를 가져옴

(userId)

- 비즈니스 로직 구현
11. 데이터베이스의 user 테이블에서 해당하는 (userId)를 가지고 있는 유저가 있는지 조회
11-1. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

12. 존재하는 user 인지 확인
12-1. 존재하지 않으면 'AF' 응답 처리

13. 'SU' 응답 처리 (userId, userRole 포함)

-------------------------------------------------------------------------------------------------------------
게시판 작성 프로세스

0. 클라이언트로부터 Authorization 헤더와 Request Body를 포함하여 요청
0-1. 권한이 없는 사용자이면 'AF' 응답처리(403)
0-2. 유효하지 않는 데이터이면 'VF' 응답처리

((title, contents), userId)

- 비즈니스 로직 구현
1. 데이터베이스의 user 테이블에서 해당 유저가 존재하는지 확인
1-1. 존재하지 않는 유저라면 'AF' 응답처리 (401)
1-2. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

2. Board 테이블에 데이터 삽입
2-1. 만약 데이트베이스 작업 중 에러가 발생하면 'DBE' 응답 처리

3. 'SU' 응답 처리